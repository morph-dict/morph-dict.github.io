<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="jquery-2.1.4.min.js" type="text/javascript"></script>
    <script>

        function jPromise(def) {
            return new Promise(function(done, fail){
                def.done(done).fail(fail);
            })
        }

        function indexResolver(perFile) {
            return function(index) {
                return {
                    base: Math.floor(index / perFile),
                    offset: index % perFile
                }
            }
        }

        function search(toSearch) {
            var dataRoot = "data";


            return jPromise($.ajax(dataRoot+"/index.json")).then(function(indexFile){
                var index = indexResolver(indexFile.itemsPerFile);
                var treeDir = dataRoot + "/" + indexFile.treeDir;

                var promise = new Promise(function (resolve, fail) {
                    function search(nextNodeIndex, rest) {

                        nextNodeIndex = index(nextNodeIndex);

                        var file = treeDir + "/" + nextNodeIndex.base + ".json";
                        jPromise($.ajax(file)).then(function (data) {
                            var next = data[nextNodeIndex.offset];
                            if (rest.length == 0) {
                                if (next[1]) {
                                    resolve({status: "found", data: next[1]});
                                }
                                else {
                                    resolve({status: "not_found", data: toSearch});
                                }
                            }
                            else {
                                var branches = next[0];
                                var branchIndex = branches[rest.charAt(0)];
                                if (branchIndex) {
                                    search(branchIndex, rest.substr(1));
                                }
                                else {
                                    resolve({status: "not_found", data: toSearch});
                                }
                            }
                        }).catch(function (xhr, e) {
                            fail(e);
                        })
                    }

                    search(indexFile.root, toSearch);
                });

                promise = promise.then(function(data){
                    if(data.status == "found") {
                        return data;
                    }
                });

                return promise;
            });
        }

        $(function () {
            $("#search").submit(function(e){
                var toSearch = $("#word").val();
                $("#result").text("searching...");
                search(toSearch).then(function(result){
                    $("#result").text(JSON.stringify(result));
                }).catch(function(e){
                    throw e;
                });
                e.preventDefault();
            });
        })
    </script>
</head>
<body>
<form id="search">
    <p><label>Word form: <input type="text" id="word" value="частнопредпринимательский"/></label><button type="submit">Search</button></p>
    <p><label>Result: <span id="result"></span></label></p>
</form>
</body>
</html>