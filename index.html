<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="jquery-2.1.4.min.js" type="text/javascript"></script>
    <script>

        function jPromise(def) {
            return new Promise(function(done, fail){
                def.done(done).fail(fail);
            })
        }

        function search(toSearch) {

            return jPromise($.ajax("data/index.json")).then(function(indexFile){
                return new Promise(function (resolve, fail) {
                    function search(nextNodeIndex, rest) {
                        var file = "data/" + Math.floor(nextNodeIndex / indexFile.linesPerFile) + ".json";
                        console.log("search: " + file);
                        jPromise($.ajax(file)).then(function (data) {
                            var offset = nextNodeIndex % indexFile.linesPerFile;
                            console.log("search done: " + file + " " + offset);
                            var next = data[offset];
                            if (rest.length == 0) {
                                if(next[1]) {
                                    resolve({status:"found", data:next[1]});
                                }
                                else {
                                    resolve({status:"not_found", data:toSearch});
                                }
                            }
                            else {
                                var branches = next[0];
                                var branchIndex = branches[rest.charAt(0)];
                                if (branchIndex) {
                                    search(branchIndex, rest.substr(1));
                                }
                                else {
                                    resolve({status:"not_found", data:toSearch});
                                }
                            }
                        }).catch(function (xhr, e) {
                            console.log("err");
                            fail(e);
                        })
                    }
                    search(indexFile.root, toSearch);
                });
            });
        }

        $(function () {
            $("#search").submit(function(e){
                var toSearch = $("#word").val();
                $("#result").text("searching...");
                search(toSearch).then(function(result){
                    $("#result").text(JSON.stringify(result));
                }).catch(function(e){
                    throw e;
                });
                e.preventDefault();
            });
        })
    </script>
</head>
<body>
<form id="search">
    <p><label>Word form: <input type="text" id="word" value="частнопредпринимательский"/></label><button type="submit">Search</button></p>
    <p><label>Result: <span id="result"></span></label></p>
</form>
</body>
</html>